// ใช้ PostgreSQL
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Prisma Client
generator client {
  provider = "prisma-client-js"
}

enum Role {
  STUDENT
  COMPANY
  TEACHER
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  role      Role
  createdAt DateTime @default(now())

  // Relation
  student Student?
  company Company?
  teacher Teacher?
}

model Student {
  id        Int      @id @default(autoincrement())
  userId    Int      @unique
  fullname  String
  phone     String?
  major     String?
  year      Int?
  createdAt DateTime @default(now())

  // Applications
  applications Application[]
  reports      Report[]

  user User @relation(fields: [userId], references: [id])
}

model Company {
  id          Int      @id @default(autoincrement())
  userId      Int      @unique
  name        String
  address     String?
  phone       String?
  description String?
  createdAt   DateTime @default(now())

  positions Position[]

  user User @relation(fields: [userId], references: [id])
}

model Teacher {
  id         Int      @id @default(autoincrement())
  userId     Int      @unique
  fullname   String
  department String?
  phone      String?
  createdAt  DateTime @default(now())

  user User @relation(fields: [userId], references: [id])
}

model Position {
  id           Int      @id @default(autoincrement())
  companyId    Int
  title        String
  description  String?
  requirements String?
  location     String?
  createdAt    DateTime @default(now())

  company      Company       @relation(fields: [companyId], references: [id])
  applications Application[]
}

model Application {
  id         Int      @id @default(autoincrement())
  studentId  Int
  positionId Int
  status     String   @default("PENDING") // PENDING / APPROVED / REJECTED
  createdAt  DateTime @default(now())

  student  Student  @relation(fields: [studentId], references: [id])
  position Position @relation(fields: [positionId], references: [id])
}

model Report {
  id        Int      @id @default(autoincrement())
  studentId Int
  week      Int
  content   String
  createdAt DateTime @default(now())

  student Student @relation(fields: [studentId], references: [id])
}
